function cc(){
	$(".chordMarkers").css("display","block"),$(".chordMarkers a").each(function(){$(this).css("opacity","0")});
	var e=$("#chord-key").val();
	if("none"==e)return $(".chordMarkers").css("display","none"),$("#chord-style").val("dur"),void 0;
	var a=$("#chord-style").val(),s=kn(e);
	switch(a){
		case"dur":
			v(s),v(s+4),v(s+7);
			break;
		case"moll":
			v(s),v(s+3),v(s+7);
			break;
		case"sus2":
			v(s),v(s+2),v(s+7);
			break;
		case"sus":
			v(s),v(s+5),v(s+7);
			break;
		case"7sus4":
			v(s),v(s+5),v(s+7),v(s+10);
			break;
		case"aug5":
			v(s),v(s+4),v(s+8);
		break;
		case"maug5":
			v(s),v(s+3),v(s+8);
			break;
		case"mm5":
			v(s),v(s+3),v(s+6);
			break;
		case"m7m5":
			v(s),v(s+3),v(s+6),v(s+10);break;
			case"6":v(s),v(s+4),v(s+7),v(s+9);break;
			case"m6":v(s),v(s+3),v(s+7),v(s+9);break;
			case"7":v(s),v(s+4),v(s+7),v(s+10);break;
			case"m7":v(s),v(s+3),v(s+7),v(s+10);break;
			case"7b9":v(s),v(s+4),v(s+7),v(s+10),v(s+13);break;
			case"7s9":v(s),v(s+4),v(s+7),v(s+10),v(s+15);break;
			case"maj7":v(s),v(s+4),v(s+7),v(s+11);break;
			case"dim7":v(s),v(s+3),v(s+6),v(s+9);break;
			case"9":v(s),v(s+4),v(s+7),v(s+10),v(s+14);
			break;case"add9":v(s),v(s+4),v(s+7),v(s+14);
			break;case"maj9":v(s),v(s+4),v(s+7),v(s+11),v(s+14);break;
			case"11":v(s),v(s+4),v(s+7),v(s+10),v(s+14),v(s+5);break;
			case"add11":v(s),v(s+4),v(s+7),v(s+5);break;
			case"13":v(s),v(s+4),v(s+7),v(s+10),v(s+14),v(s+5),v(s+9)
	}
}
function kn(e){
	switch(e){
		case"c":e=0;break;
		case"cs":e=1;break;
		case"d":e=2;break;
		case"ds":e=3;break;
		case"e":e=4;break;
		case"f":e=5;break;
		case"fs":e=6;break;
		case"g":e=7;break;
		case"gs":e=8;break;
		case"a":e=9;break;
		case"as":e=10;break;
		case"b":e=11;break;
		case"c1":e=12;break;
		case"cs1":e=13;break;
		case"d1":e=14;break;
		case"ds1":e=15;break;
		case"e1":e=16;break;
		case"f1":e=17;break;
		case"fs1":e=18;break;
		case"g1":e=19;break;
		case"gs1":e=20;break;
		case"a1":e=21;break;
		case"as1":e=22;break;
		case"b1":e=23;break;
		case"c2":e=24;break;
		case 0:e="c";break;
		case 1:e="cs";break;
		case 2:e="d";break;
		case 3:e="ds";break;
		case 4:e="e";break;
		case 5:e="f";break;
		case 6:e="fs";break;
		case 7:e="g";break;
		case 8:e="gs";break;
		case 9:e="a";break;
		case 10:e="as";break;
		case 11:e="b";break;
		case 12:e="c1";break;
		case 13:e="cs1";break;
		case 14:e="d1";break;
		case 15:e="ds1";break;
		case 16:e="e1";break;
		case 17:e="f1";break;
		case 18:e="fs1";break;
		case 19:e="g1";break;
		case 20:e="gs1";break;
		case 21:e="a1";break;
		case 22:e="as1";break;
		case 23:e="b1";break;
		case 24:e="c2"}
	return e
}
function v(e){
	e>24&&(e-=12),n=kn(e),$("a."+n).css("opacity","1"),pn(e)}
function lv(e,a){
	$("#loading").css("display","block"),$("#voice").html(a),$("#sound").html("");
	for(var s=0;sounds>s;s++)$("<audio>").attr({id:"snd_"+s,oncanplaythrough:"la()"}).appendTo($("#sound")),$("<source>").attr({src:"snd/"+e+"/"+s+".mp3",type:"audio/mpeg"}).appendTo($("audio#snd_"+s)),$("<source>").attr({src:"snd/"+e+"/"+s+".ogg",type:"audio/ogg"}).appendTo($("audio#snd_"+s))}
function pn(e){
	var a=document.querySelector("#snd_"+e);a.pause(),a.currentTime=0,a.play()}
function la(){lss+=1,document.querySelector("#num").innerHTML=Math.round(lss/25*100)+"%",lss==sounds&&($("#loading").css("display","none"),lss=0,$("#num").html("0%"))}
function kcVal(e){
	var a="#key";
	switch(e){
		case"90":a+="C";break;
		case"88":a+="D";break;
		case"67":a+="E";break;
		case"86":a+="F";break;
		case"66":a+="G";break;
		case"78":a+="A";break;
		case"77":a+="B";break;
		case"81":a+="C1";break;
		case"87":a+="D1";break;
		case"69":a+="E1";break;
		case"82":a+="F1";break;
		case"84":a+="G1";break;
		case"89":a+="A1";break;
		case"85":a+="B1";break;
		case"73":a+="C2";break;
		case"83":a+="CS";break;
		case"68":a+="DS";break;
		case"71":a+="FS";break;
		case"72":a+="GS";break;
		case"74":a+="AS";break;
		case"50":a+="CS1";break;
		case"51":a+="DS1";break;
		case"53":a+="FS1";break;
		case"54":a+="GS1";break;
		case"55":a+="AS1"}
	return a
}
function canPlayKey(e){
	return!window.keysPlaying.contains(e)}
var lss=0,sounds=25;
Array.prototype.contains=function(e){return!!(this.indexOf(e)+1)},Array.prototype.remove=function(e){this.indexOf(e)>-1&&this.splice(this.indexOf(e),1)},window.keysPlaying=[],window.addEventListener("keydown",function(e){var a=kcVal("which"in e?e.which+"":e.keyCode+"");
return canPlayKey(a)&&(pn(kn(a.toLowerCase().split("key")[1])),window.keysPlaying.push(a)),-1==a.indexOf("S")?(document.querySelector(a).classList.add("keyActive"),void 0):(document.querySelector(a).classList.add("keySActive"),void 0)},!1),window.addEventListener("keyup",function(e){var a=kcVal("which"in e?e.which+"":e.keyCode+"");
return canPlayKey(a)||window.keysPlaying.remove(a),-1==a.indexOf("S")?(document.querySelector(a).classList.remove("keyActive"),void 0):(document.querySelector(a).classList.remove("keySActive"),void 0)},!1),window.addEventListener("load",function(){lv(0,"Grand Piano"),document.querySelector("#chord-key").addEventListener("change",cc,!1),document.querySelector("#chord-style").addEventListener("change",cc,!1),window.addEventListener("mousedown",function(e){var a=e.target;"A"===e.target.nodeName&&(a=e.target.parentNode),-1!==a.id.indexOf("key")&&pn(kn(a.id.split("key")[1].toLowerCase()))},!1)},!1);